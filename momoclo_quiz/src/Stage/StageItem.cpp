//******************************************************************************
//	ファイル名	：	StageItem.cpp
//	作成者		：	kageyama taiki
//	作成日		：	2012/05/01
//	機能		：	アイテム
//------------------------------------------------------------------------------
//	更新履歴	：	
//
//******************************************************************************
//------------------------------------------------------------
//	呼ばなければいけないヘッダ
//------------------------------------------------------------
#include	"Stage.h"
#include	"StageItem.h"
//------------------------------------------------------------
//	呼びたいヘッダ
//------------------------------------------------------------
#include	"StageMap.h"
//------------------------------------------------------------
//	変数や宣言
//------------------------------------------------------------
using namespace stage;
//------------------------------------------------------------
//	コンストラクタ
//------------------------------------------------------------
C_Item::C_Item(const char* fileName) : C_Base(fileName)
{
	item_reset();

	mImage = C_BaseManager::SetLoadImage(mImageFileName.c_str());
	OutputDebugString("constructor:C_Item\n");
}

//------------------------------------------------------------
//	デストラクタ
//------------------------------------------------------------
C_Item::~C_Item()
{
	OutputDebugString("destructor:C_Item\n");
}

//------------------------------------------------------------
//	描画
//------------------------------------------------------------
void C_Item::Draw()
{
	Draw_Box(mPosX * 32, mPosY * 32, mPosX * 32 + 32, mPosY * 32 +32, 0xff00ff00, 0xff00ff00, 1, 1, 0.2f); 

//	GetDraw_TpBitmap();
}

//------------------------------------------------------------
//	制御
//------------------------------------------------------------
bool C_Item::Control()
{
	return false;
}

//------------------------------------------------------------
//	アイテム生成
//------------------------------------------------------------
void C_Item::item_reset()
{
	int cnt = 0;
	mPosX = 0;
	mPosY = 0;
	//this_item = -1;

	C_Map* map = GET_OBJECT(C_Map* ,C_Stage::OBJ_MAP);
	
	while(cnt == 0)
	{
		int x,y;

		x = rand()%10;
		y = rand()%15;

		mPosX = x;
		mPosY = y;

		this_item = map->GetMapArray(static_cast<int>(mPosX), static_cast<int>(mPosY));

		if(this_item == 0)
		{
			cnt++;
		}
	}

	//return false;
}